<mxfile host="app.diagrams.net" modified="2020-12-23T06:41:20.325Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36" etag="b5BhIlqTOi0cT4k1AbXt" version="14.1.1" type="github">
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="Page-1">
    <mxGraphModel dx="2023" dy="1696" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="1Uik45kLceN-WnxneO16-1" value="&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;b&gt;日内处理/EOD处理-调账处理&lt;/b&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="505" y="-380" width="260" height="40" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.96;exitY=0.7;exitDx=0;exitDy=0;exitPerimeter=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-3" target="1Uik45kLceN-WnxneO16-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="225" />
              <mxPoint x="360" />
              <mxPoint x="360" y="-210" />
            </Array>
            <mxPoint x="400" y="-170" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-7" value="FIX消息&lt;br&gt;type=correction/cancel" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="1Uik45kLceN-WnxneO16-6" vertex="1" connectable="0">
          <mxGeometry x="-0.1686" y="-2" relative="1" as="geometry">
            <mxPoint x="-135.82999999999998" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-3" value="FIX" style="ellipse;shape=cloud;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-200" y="-250" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.939;entryY=0.4;entryDx=0;entryDy=0;entryPerimeter=0;shadow=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-4" target="1Uik45kLceN-WnxneO16-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-4" value="WEBULL" style="shape=document;whiteSpace=wrap;html=1;boundedLbl=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="289.06" y="-210" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="490" y="400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-10" value="开始" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="440" y="280" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-13" target="1Uik45kLceN-WnxneO16-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-13" target="1Uik45kLceN-WnxneO16-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-13" value="type类型" style="rhombus;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="450" y="400" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-14" target="1Uik45kLceN-WnxneO16-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-14" value="correction&lt;br&gt;修改" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="270" y="410" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-30" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-16" target="1Uik45kLceN-WnxneO16-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-16" value="cancel&lt;br&gt;取消" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="590" y="410" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-18" target="1Uik45kLceN-WnxneO16-23" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="500" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-18" value="新建日志记录&lt;br&gt;一条correction数据" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="270" y="550" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-34" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-23" target="1Uik45kLceN-WnxneO16-33" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-23" value="调用交易引擎-&lt;br&gt;进行资产变更" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="440" y="660" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-29" target="1Uik45kLceN-WnxneO16-23" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="500" y="580" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-29" value="新建日志记录&lt;br&gt;一条type=correction数据" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="590" y="550" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-31" value="&lt;div&gt;&lt;div&gt;记录修改日志&lt;/div&gt;&lt;div&gt;t_execution_break_log{&lt;/div&gt;&lt;div&gt;id:&quot;主键&quot;,&lt;/div&gt;&lt;div&gt;original_exec_id:&quot;old_execution_Id&quot;,&lt;/div&gt;&lt;div&gt;&lt;div&gt;order_id:&quot;订单id&quot;&lt;/div&gt;&lt;div&gt;sub_order_id:&quot;子订单&quot;&lt;/div&gt;&lt;div&gt;execu_order_id:&quot;执行订单&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;type:&quot;trade_cancel&quot;,&lt;/div&gt;&lt;div&gt;total_quantity:&quot;总数&quot;,&lt;/div&gt;&lt;div&gt;strike_price:&quot;成交价&quot;,&lt;/div&gt;&lt;div&gt;transact_time:&quot;成交时间&quot;,&lt;/div&gt;&lt;div&gt;seq_no:&quot;顺序&quot;,&lt;/div&gt;&lt;div&gt;create_time:&quot;创建时间&quot;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;之前的数据old_execution上直接修改数据&lt;/div&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="720" y="290" width="280" height="250" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-36" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-33" target="1Uik45kLceN-WnxneO16-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-38" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-33" target="1Uik45kLceN-WnxneO16-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-33" value="记录exec_id --&lt;br&gt;盘后订单execution&lt;br&gt;重排" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="440" y="790" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-35" value="结束" style="ellipse;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="440" y="910" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-37" value="存储DB" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="640" y="790" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-39" value="&lt;div&gt;需要重排数据&lt;/div&gt;&lt;div&gt;t_replay_exec{&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;id:&quot;主键&quot;&lt;/div&gt;&lt;div&gt;&lt;span&gt; &lt;/span&gt;execId:&quot;执行订单id，如果存在重复的，程序去重处理&quot;,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; status:&quot;是否已经执行过&quot;,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; create_time:&quot;创建时间&quot;,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; update_time:&quot;更新时间&quot;,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;type:&quot;类型 1 fix日内 2 fix Eod&quot;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="790" y="745" width="320" height="150" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-40" value="&lt;font style=&quot;font-size: 18px&quot;&gt;&lt;b&gt;日内处理/EOD处理-execution重排处理&lt;/b&gt;&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="335" y="990" width="330" height="10" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-44" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-41" target="1Uik45kLceN-WnxneO16-43" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-41" value="开始" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="450" y="1040" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-42" value="结束" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="515" y="1520" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-46" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-43" target="1Uik45kLceN-WnxneO16-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-43" value="定时任务启动，&lt;br&gt;检测是否存在&lt;br&gt;&lt;span style=&quot;text-align: left&quot;&gt;重排数据需要处理&lt;/span&gt;" style="whiteSpace=wrap;html=1;strokeWidth=2;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="440" y="1140" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-49" value="不存在" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-45" target="1Uik45kLceN-WnxneO16-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-52" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-45" target="1Uik45kLceN-WnxneO16-51" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-45" value="是否存在重排&lt;br&gt;数据需要执行" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="450" y="1240" width="100" height="100" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-47" value="&lt;b&gt;在送清算之前，进行重排处理。&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="180" y="1100" width="180" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-48" target="1Uik45kLceN-WnxneO16-42" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-48" value="发送通知告知&lt;br&gt;相关人员" style="whiteSpace=wrap;html=1;strokeWidth=2;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="505" y="1420" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-54" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-51" target="1Uik45kLceN-WnxneO16-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-51" value="按着execOrderId取出execution 按着bizoffset排序" style="whiteSpace=wrap;html=1;strokeWidth=2;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="260" y="1260" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-86" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-53" target="1Uik45kLceN-WnxneO16-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;shadow=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-53" target="l4X3YuBK7rbhBfaj7fvv-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-53" value="进行数据的重放&lt;br&gt;exection_log、&lt;br&gt;execution &lt;br&gt;相关重放数据.&lt;br&gt;update之前的executionId&amp;nbsp;" style="whiteSpace=wrap;html=1;strokeWidth=2;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="230.94" y="1360" width="178.12" height="70" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-57" value="&lt;span style=&quot;font-size: 18px&quot;&gt;&lt;b&gt;清算商调账&lt;/b&gt;&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="350" y="1610" width="330" height="10" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-62" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-59" target="1Uik45kLceN-WnxneO16-61" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-59" value="开始" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="1754" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-60" value="结束" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="2674" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-64" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-61" target="1Uik45kLceN-WnxneO16-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-66" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-61" target="1Uik45kLceN-WnxneO16-65" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-68" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-61" target="1Uik45kLceN-WnxneO16-67" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-61" value="type" style="rhombus;whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="480" y="1894" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-72" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-63" target="1Uik45kLceN-WnxneO16-71" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-63" value="Trade Cancel&lt;br&gt;取消execution" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="680" y="1889" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-70" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-65" target="1Uik45kLceN-WnxneO16-69" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-65" value="Trade Correction&lt;br&gt;修改记录&lt;br&gt;成交价格不对" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="160" y="1889" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-74" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-67" target="1Uik45kLceN-WnxneO16-73" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-67" value="Trade Cancel rebuild&lt;br&gt;取消订单-重新下单" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="470" y="2004" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-78" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-69" target="1Uik45kLceN-WnxneO16-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-69" value="新增一条&lt;br&gt;修改之后&lt;br&gt;execution" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-30" y="1884" width="120" height="65" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-71" target="1Uik45kLceN-WnxneO16-77" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="960" y="1949" />
              <mxPoint x="960" y="2354" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-71" value="新增一条相反方向&lt;br&gt;execution" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="890" y="1889" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-80" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-73" target="1Uik45kLceN-WnxneO16-77" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-73" value="新增两条记录&lt;br&gt;与原纪录一样，方向相反(一条cancel)&lt;br&gt;修改的成交数量(一条new create项目)" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="405" y="2144" width="250" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-75" value="&lt;div&gt;execution{&lt;/div&gt;&lt;div&gt;type:“trade_cancel”&lt;/div&gt;&lt;div&gt;reason_code:&quot;&lt;b&gt;trade_break_cancel_execution&lt;/b&gt;&quot;,&lt;/div&gt;&lt;div&gt;original_exec_id:&quot;撤销的execId&quot;,&lt;/div&gt;&lt;div&gt;symbol:&quot;同修改前的记录&quot;,&lt;/div&gt;&lt;div&gt;&lt;b&gt;side:&quot;同修改前的记录相反&quot;&lt;/b&gt;,&lt;/div&gt;&lt;div&gt;status:&quot;normal&quot;,&lt;/div&gt;&lt;div&gt;&lt;b&gt;&quot;exec_time&quot;：&quot;修改前的记录的时间处理&quot;,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&quot;biz_offset&quot;:&quot;&lt;/b&gt;old_execution.biz_offset+1&lt;b&gt;&quot;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&quot;其它相关属性不变化&quot;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;....&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;old_execution 状态修改为&amp;nbsp;&lt;b&gt;cancel&lt;/b&gt;&lt;/div&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="1030" y="1780" width="290" height="250" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-76" value="&lt;div&gt;execution{&lt;/div&gt;&lt;div&gt;type:“trade_correction”&lt;/div&gt;&lt;div&gt;reason_code:&quot;&lt;b&gt;trade_break_trade_correction&lt;/b&gt;&quot;,&lt;/div&gt;&lt;div&gt;original_exec_id:&quot;原始记录的execId&quot;,&lt;/div&gt;&lt;div&gt;symbol:&quot;同修改前的记录&quot;,&lt;/div&gt;&lt;div&gt;&lt;b&gt;side:&quot;同修改前的记录一致&quot;&lt;/b&gt;,&lt;/div&gt;&lt;div&gt;status:&quot;normal&quot;,&lt;/div&gt;&lt;div&gt;&quot;成交价格&quot;:&quot;修改后的&quot;，&lt;/div&gt;&lt;div&gt;&lt;b&gt;&quot;exec_time&quot;：&quot;修改前的记录的时间处理&quot;,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&quot;biz_offset&quot;:&quot;&lt;/b&gt;old_execution.biz_offset+1&lt;b&gt;&quot;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&quot;其它相关属性不变化&quot;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;....&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;old_execution 状态修改为&lt;b&gt;break_Correction&lt;/b&gt;&lt;/div&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="-370" y="1814" width="300" height="230" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-84" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-77" target="1Uik45kLceN-WnxneO16-83" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-77" value="调用交易引擎-&lt;br&gt;进行资产变更&lt;br&gt;盘后是否能" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="470" y="2324" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-81" value="&lt;div&gt;取消记录&lt;/div&gt;&lt;div&gt;execution{&lt;/div&gt;&lt;div&gt;type:“rebuild_cancel”&lt;/div&gt;&lt;div&gt;reason_code:&quot;&lt;b&gt;Trade break，trade cancel rebuild, cancel execution&lt;/b&gt;&quot;,&lt;/div&gt;&lt;div&gt;original_exec_id:&quot;old_execId&quot;,&lt;/div&gt;&lt;div&gt;symbol:&quot;同old&quot;,&lt;/div&gt;&lt;div&gt;&lt;b&gt;side:&quot;同修改前的记录相反&quot;&lt;/b&gt;,&lt;/div&gt;&lt;div&gt;status:&quot;normal&quot;,&lt;/div&gt;&lt;div&gt;&lt;b&gt;&quot;exec_time&quot;：&quot;23:59:59&quot;,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&quot;biz_offset&quot;:&quot;&lt;/b&gt;old_execution.biz_offset+1&lt;b&gt;&quot;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&quot;其它相关属性不变化&quot;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;....&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;old_execution 状态修改为&amp;nbsp;&lt;b&gt;break&lt;/b&gt;&lt;/div&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="670" y="2014" width="280" height="240" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-82" value="&lt;div&gt;新增记录&lt;/div&gt;&lt;div&gt;execution{&lt;/div&gt;&lt;div&gt;type:“rebuild_rebuild”&lt;/div&gt;&lt;div&gt;reason_code:&quot;&lt;b&gt;Trade break，trade cancel rebuild, rebuild execution&lt;/b&gt;&quot;,&lt;/div&gt;&lt;div&gt;original_exec_id:&quot;old_execId&quot;,&lt;/div&gt;&lt;div&gt;symbol:&quot;同修改前的记录&quot;,&lt;/div&gt;&lt;div&gt;&lt;b&gt;side:&quot;同old&quot;&lt;/b&gt;,&lt;/div&gt;&lt;div&gt;status:&quot;normal&quot;,&lt;/div&gt;&lt;div&gt;&lt;b&gt;&quot;exec_time&quot;：&quot;&lt;/b&gt;&lt;b&gt;23:59:59&lt;/b&gt;&lt;b&gt;&quot;,&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&quot;biz_offset&quot;:&quot;&lt;/b&gt;old_execution.biz_offset+2&lt;b&gt;&quot;&lt;/b&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&quot;其它相关属性不变化&quot;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;....&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;div&gt;old_execution 状态修改 &lt;b&gt;break&lt;/b&gt;&lt;/div&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;align=left;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="95" y="2024" width="295" height="240" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shadow=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="1Uik45kLceN-WnxneO16-83" target="l4X3YuBK7rbhBfaj7fvv-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1Uik45kLceN-WnxneO16-83" value="execution重排" style="whiteSpace=wrap;html=1;" parent="WIyWlLk6GJQsqaUBKTNV-1" vertex="1">
          <mxGeometry x="470" y="2464" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-0" value="&lt;div&gt;&lt;div&gt;记录修改日志&lt;/div&gt;&lt;div&gt;t_execution_fix_break_log{&lt;/div&gt;&lt;div&gt;id:&quot;主键&quot;,&lt;/div&gt;&lt;div&gt;original_exec_id:&quot;old_execution_Id&quot;,&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;order_id:&quot;订单id&quot;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;sub_order_id:&quot;子订单&quot;&lt;/div&gt;&lt;div&gt;execu_order_id:&quot;执行订单&quot;&lt;/div&gt;&lt;div&gt;type:&quot;trade_correction&quot;,&lt;/div&gt;&lt;div&gt;total_quantity:&quot;总数&quot;,&lt;/div&gt;&lt;div&gt;strike_price:&quot;成交价&quot;,&lt;/div&gt;&lt;div&gt;transact_time:&quot;成交时间&quot;,&lt;/div&gt;&lt;div&gt;seq_no:&quot;顺序&quot;,&lt;/div&gt;&lt;div&gt;create_time:&quot;创建时间&quot;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;之前的数据old_execution上直接修改数据&lt;/div&gt;" style="shape=ext;double=1;rounded=1;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-40" y="280" width="286.24" height="250" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-8" value="execution重排&lt;br&gt;execution的count不变&lt;br&gt;要保证execId不变化，&lt;br&gt;做更新操作" style="whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-27.18" y="1360" width="147.18" height="70" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-10" value="&lt;span style=&quot;text-align: left&quot;&gt;具体的fix消息返回内容的&lt;/span&gt;&lt;br style=&quot;text-align: left&quot;&gt;&lt;span style=&quot;text-align: left&quot;&gt;具体格式？&lt;/span&gt;&lt;br style=&quot;text-align: left&quot;&gt;&lt;span style=&quot;text-align: left&quot;&gt;因为涉及到两个过程 日内/EOD处理&lt;/span&gt;&lt;br style=&quot;text-align: left&quot;&gt;&lt;div style=&quot;text-align: left&quot;&gt;select&amp;nbsp; t.* from&amp;nbsp; t_execution t&amp;nbsp; ;&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;新增-清算商对账状态&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;exec_type&lt;/b&gt;&amp;nbsp;= (Transaction 默认、trade_cancel 取消、trade_correction 修正、rebuild_cancel、rebuild_rebuild、break_banance_close、break_banance)&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;exec_status&lt;/b&gt;&amp;nbsp;(新增类型 normal、break_cancel、break_correction、break_cancel_rebuild、closed)&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;reason_code&lt;/b&gt;&amp;nbsp;( Trade_break_Cancel、Trade_break_Correction、Trade_cancel_rebuild)&lt;/div&gt;&lt;div style=&quot;text-align: left&quot;&gt;&lt;b&gt;original_exec_id&lt;/b&gt;:&quot;原始记录的execId,能否直接用ref_open_id&quot;,&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#FF0000;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="-490" y="570" width="410" height="250" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;shadow=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="l4X3YuBK7rbhBfaj7fvv-11" target="1Uik45kLceN-WnxneO16-60">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l4X3YuBK7rbhBfaj7fvv-11" value="更新&lt;br&gt;order、&lt;br&gt;sub_order、exec_order" style="whiteSpace=wrap;html=1;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="470" y="2564" width="120" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
